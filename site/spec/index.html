<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>AIM Specification</title>
    <link rel="stylesheet" href="../assets/site.css">
      <!-- 100% privacy-first analytics -->
      <script data-collect-dnt="true" async src="https://scripts.simpleanalyticscdn.com/latest.js"></script>
  </head>
  <body data-page="spec" data-base="../">
    <section class="panel" style="margin-bottom: var(--space-lg);">
      <h1 style="margin:0 0 var(--space-md);">AIM Specification</h1>
      <p class="muted" style="margin:0;">
        This page renders <code>specification.md</code> directly.
        <a id="spec-link" href="../../specification.md" target="_blank" rel="noopener">Open raw spec file</a>.
      </p>
    </section>

    <section class="panel">
      <div id="spec-content">Loading specification...</div>
    </section>

    <script src="../assets/chrome.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script>
      async function fetchFirst(urls) {
        for (const url of urls) {
          try {
            const res = await fetch(url);
            if (res.ok) {
              return { url, res };
            }
          } catch (_) {}
        }
        throw new Error("No candidate path resolved.");
      }

      async function renderSpec() {
        const el = document.getElementById("spec-content");
        const link = document.getElementById("spec-link");
        const candidates = ["../specification.md", "../../specification.md", "/specification.md"];
        try {
          const { url, res } = await fetchFirst(candidates);
          link.href = url;
          const md = await res.text();
          if (window.marked && typeof window.marked.parse === "function") {
            el.innerHTML = window.marked.parse(md);
          } else {
            el.innerHTML = `<pre>${md.replaceAll("&", "&amp;").replaceAll("<", "&lt;").replaceAll(">", "&gt;")}</pre>`;
          }
        } catch (_) {
          const hint = window.location.protocol === "file:" ? " Open this site via a local HTTP server." : "";
          el.innerHTML = `<p class="err">Failed to load specification.md from local or deployed paths.${hint}</p>`;
        }
      }

      renderSpec();
    </script>
  </body>
</html>